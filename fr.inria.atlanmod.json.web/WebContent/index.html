
<!DOCTYPE html>
<html>
<head>
    <title>JSON discoverer</title>
    <meta name="description" content="JSON discoverer">
    <meta name="author" content="Javier Canovas">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/bootstrap-theme.css">
    <link rel="stylesheet" href="css/style.css" media="screen">
</head>
<body>

<div class="container">

    <div class="row">
    <div class="jumbotron">
    	<div class="container">
    	<h1>JSON discoverer</h1>
   	 	<h2>Discover your domain models from JSON files</h2>
   		</div>
    </div>
    </div>

    <div class="row">
    <h2>What is this?</h2>
    <p>The JSON discoverer is a tool that allows you to <trong>get a UML class diagram out of your JSON files</strong>.</p>
    <p>The tool is inspired in the research paper <a href="http://hal.inria.fr/docs/00/81/89/45/PDF/icwe2013-CanovasCabot.pdf"><em>Discovering Implicit Schemas in JSON Data</em></a> published in the <a href="http://icwe2013.webengineering.org/">ICWE'13 conference</a>.</p>
    <p> So far, this web implementation performs the first step consisting in getting a domain model out of the JSON files. We plan to incorporate the rest of the phases in the coming weeks.<p>
    </div>


    <div class="row">
	<div class="col-md-12">
	<h3>Your JSON definition</h3>
	<p>Copy/Paste your JSON text file here:</p>
	</div>
    <div class="col-md-8">
	<form role="form">
		<div class="form-group">
			<p><textarea rows="10" id="json" resiable="false"></textarea></p>			
		</div>
	</form>
	</div>
	<div class="col-md-4">
		<p class="text-center">
			<div class="btn-group">
				<button id="discoverDomainModel" class="btn btn-primary" type="button" onclick="discover(document.getElementById('json').value)" disabled>Discover domain model</button>
				<button id="refineDomainModel" class="btn" type="button" onclick="discover(document.getElementById('json').value)" disabled>Refine domain model</button>
			</div>
		</p>
		<p class="text-center">
			<button id="refineDomainModel" class="btn" type="button" onclick="discover(document.getElementById('json').value)" disabled>Reset</button>
		</p>
	</div>
	</div>

    <div class="row">
	<div class="col-md-6">
		<h3>Your Domain Model</h3>
    	<p class="text-center"><img id="metamodel" src="" class="img-rounded"></p>
	</div>
	<div class="col-md-6">
		<h3>Your Instance Model</h3>
    	<p class="text-center"><img id="model" src="" class="img-rounded"></p>
	</div>
	</div>
</div>

<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.js"></script>
<script>
$('#json').on("keyup input change", function () {
	$('#discoverDomainModel').prop('disabled', !$('#json').val());
});

var discover = function (jsonData) {
	$.ajax({
		type : "POST",
		url : "http://localhost:8080/fr.inria.atlanmod.json.web/discoverMetamodel",
		data : { json : jsonData },
		beforeSend : function() {
			var image = document.getElementById('metamodel');
			image.src = "images/loading.gif";
		},
		success : function(data) {
			var image = document.getElementById('metamodel');
			image.src = "data:image/jpg;base64," + data;
			//$('#refineDomainModel').prop({ disabled: false });
			//$('#refineDomainModel').addClass("btn-primary");
			//$('#discoverDomainModel').removeClass("btn-primary");
			$('#json').prop('value', "");
			$('#discoverDomainModel').prop('disabled', !$('#json').val());
		},
		dataType : "text"
	});

	$.ajax({
		type : "POST",
		url : "http://localhost:8080/fr.inria.atlanmod.json.web/injectModel",
		data : { json : jsonData },
		beforeSend : function() {
			var image = document.getElementById('model');
			image.src = "images/loading.gif";
		},
		success : function(data) {
			var image = document.getElementById('model');
			image.src = "data:image/jpg;base64," + data;
		},
		dataType : "text"
	});
};
</script>

</body>
</html>
